CREATE PROC [dwhcda].[SP_21_AP_Pur_Order_Lines_fct] AS
BEGIN

	SET NOCOUNT ON;
	
	IF OBJECT_ID('tempdb..[#ap_PU_Order_Lines]', 'U') IS NOT NULL
	DROP TABLE #ap_PU_Order_Lines

    Select * INTO [#ap_PU_Order_Lines]    
	From [dwhcda].[lnc_fct_AP_Pur_Order_Lines] where 1 = 2;

	BEGIN TRANSACTION;

	BEGIN TRY
		
--Purchase Order Lines
	Insert into #ap_PU_Order_Lines
	( [acti],[adin],[akcd],[amld],[amod],[appr],[appr_kw],[bgrb],[bgrb_kw],[bgrq],[bgrq_kw],[bgxc],[bgxc_kw],[bkyn],[bkyn_kw],[bpcl],[bptc],[btsp],[btsp_kw],[btx1],[btx2],[cact],[cadr],[casi],[ccco],[ccof],[ccty],[cdec],[cdf_jbtd],[cdis_1],[cdis_10],[cdis_11],[cdis_2],[cdis_3],[cdis_4],[cdis_5],[cdis_6],[cdis_7],[cdis_8],[cdis_9],[ceno],[cfrw],[citt],[clip],[clip_kw],[clot],[clyn],[clyn_kw],[cmnf],[cncd],[cnig],[cnig_kw],[comm],[comm_kw],[compnr],[cono],[coop_1],[coop_2],[coop_3],[coop_trnc],[copr_1],[copr_2],[copr_3],[copr_trnc],[corg],[corg_kw],[cosn],[cpay],[cpcl],[cpcp],[cpln],[cpon],[cprj],[cpva],[crbn],[crbn_kw],[crcd],[crej],[crit],[crrf],[crrf_kw],[csgp],[cspa],[csqn],[cstl],[ctcd],[ctrj],[cubp],[cupp],[cuqp],[cuva],[cvat],[cvbp],[cvpp],[cvqp],[cwar],[damt],[ddon],[ddta],[ddtb],[ddtc],[ddtd],[ddte],[ddtf],[deleted],[dino],[disc_1],[disc_10],[disc_11],[disc_2],[disc_3],[disc_4],[disc_5],[disc_6],[disc_7],[disc_8],[disc_9],[dmde_1],[dmde_10],[dmde_11],[dmde_2],[dmde_3],[dmde_4],[dmde_5],[dmde_6],[dmde_7],[dmde_8],[dmde_9],[dmse_1],[dmse_10],[dmse_11],[dmse_2],[dmse_3],[dmse_4],[dmse_5],[dmse_6],[dmse_7],[dmse_8],[dmse_9],[dmth_1],[dmth_10],[dmth_11],[dmth_2],[dmth_3],[dmth_4],[dmth_5],[dmth_6],[dmth_7],[dmth_8],[dmth_9],[dmth_kw_1],[dmth_kw_10],[dmth_kw_11],[dmth_kw_2],[dmth_kw_3],[dmth_kw_4],[dmth_kw_5],[dmth_kw_6],[dmth_kw_7],[dmth_kw_8],[dmth_kw_9],[dmty_1],[dmty_10],[dmty_11],[dmty_2],[dmty_3],[dmty_4],[dmty_5],[dmty_6],[dmty_7],[dmty_8],[dmty_9],[dmty_kw_1],[dmty_kw_10],[dmty_kw_11],[dmty_kw_2],[dmty_kw_3],[dmty_kw_4],[dmty_kw_5],[dmty_kw_6],[dmty_kw_7],[dmty_kw_8],[dmty_kw_9],[dorg_1],[dorg_10],[dorg_11],[dorg_2],[dorg_3],[dorg_4],[dorg_5],[dorg_6],[dorg_7],[dorg_8],[dorg_9],[dorg_kw_1],[dorg_kw_10],[dorg_kw_11],[dorg_kw_2],[dorg_kw_3],[dorg_kw_4],[dorg_kw_5],[dorg_kw_6],[dorg_kw_7],[dorg_kw_8],[dorg_kw_9],[dtrm],[dtrm_kw],[effn],[elgb],[elgb_kw],[etpc],[etpc_kw],[exmt],[exmt_kw],[fire],[fire_kw],[gefo],[gefo_kw],[glco],[iamt],[invd],[invn],[issp],[issp_kw],[item],[lcam_trnc],[lccl],[lcrq],[lcrq_kw],[ldam_1],[ldam_10],[ldam_11],[ldam_2],[ldam_3],[ldam_4],[ldam_5],[ldam_6],[ldam_7],[ldam_8],[ldam_9],[ldat],[leng],[lsel],[lsel_kw],[lseq],[mitm],[mpnr],[mpsn],[oamt],[odat],[oltp],[oltp_kw],[orno],[otbp],[ownr],[owns],[owns_kw],[paft],[paft_kw],[paya],[pegd],[pegd_kw],[pmde],[pmnd],[pmnd_kw],[pmni],[pmni_kw],[pmnt],[pmnt_kw],[pmse],[pmsk],[pono],[porg],[porg_kw],[pric],[prsg],[pseq],[ptpa],[ptpe],[qbbc],[qbbc_buar],[qbbc_buln],[qbbc_bupc],[qbbc_butm],[qbbc_buvl],[qbbc_buwg],[qbbc_invu],[qbbc_trnu],[qiap],[qiap_buar],[qiap_buln],[qiap_bupc],[qiap_butm],[qiap_buvl],[qiap_buwg],[qiap_trnu],[qibo],[qibo_buar],[qibo_buln],[qibo_bupc],[qibo_butm],[qibo_buvl],[qibo_buwg],[qibo_invu],[qibo_trnu],[qibp],[qidl],[qidl_buar],[qidl_buln],[qidl_bupc],[qidl_butm],[qidl_buvl],[qidl_buwg],[qidl_trnu],[qiiv],[qiiv_buar],[qiiv_buln],[qiiv_bupc],[qiiv_butm],[qiiv_buvl],[qiiv_buwg],[qiiv_trnu],[qips],[qirj],[qirj_buar],[qirj_buln],[qirj_bupc],[qirj_butm],[qirj_buvl],[qirj_buwg],[qirj_trnu],[qoor],[qoor_buar],[qoor_buln],[qoor_bupc],[qoor_butm],[qoor_buvl],[qoor_buwg],[qoor_invu],[qual],[qual_kw],[rcno],[rcod],[rdta],[revi],[rseq],[sbim],[sbim_kw],[sbmt],[sdsc],[sdsc_kw],[serl],[serv],[sfad],[sfbp],[sfcn],[sfsi],[sfwh],[site],[spcn],[sqnb],[stdc],[stsc],[stsc_kw],[stsd],[stsd_kw],[subc],[subc_kw],[tapr],[taxp],[taxp_kw],[thic],[ztimestamp],[tpbk],[tpbl],[txta],[vryn],[vryn_kw],[widt],[file_name],[dwh_load_time],[otad],[prno],[ccur],[crin_kw],[ifbp],[ccrs],[hisp_kw],[cvyn_kw],[odis],[ptad],[ptbp],[ptcn],[plnr],[cotp],[hdst_kw],[PU_Order_Lines_fct_key])
	SELECT A.[acti],A.[adin],A.[akcd],A.[amld],A.[amod],A.[appr],A.[appr_kw],A.[bgrb],A.[bgrb_kw],A.[bgrq],A.[bgrq_kw],A.[bgxc],A.[bgxc_kw],A.[bkyn],A.[bkyn_kw],A.[bpcl],A.[bptc],A.[btsp],A.[btsp_kw],A.[btx1],A.[btx2],A.[cact],A.[cadr],A.[casi],A.[ccco],A.[ccof],A.[ccty],A.[cdec],A.[cdf_jbtd],A.[cdis_1],A.[cdis_10],A.[cdis_11],A.[cdis_2],A.[cdis_3],A.[cdis_4],A.[cdis_5],A.[cdis_6],A.[cdis_7],A.[cdis_8],A.[cdis_9],A.[ceno],A.[cfrw],A.[citt],A.[clip],A.[clip_kw],A.[clot],A.[clyn],A.[clyn_kw],A.[cmnf],A.[cncd],A.[cnig],A.[cnig_kw],A.[comm],A.[comm_kw],A.[compnr],A.[cono],A.[coop_1],A.[coop_2],A.[coop_3],A.[coop_trnc],A.[copr_1],A.[copr_2],A.[copr_3],A.[copr_trnc],A.[corg],A.[corg_kw],A.[cosn],A.[cpay],A.[cpcl],A.[cpcp],A.[cpln],A.[cpon],A.[cprj],A.[cpva],A.[crbn],A.[crbn_kw],A.[crcd],A.[crej],A.[crit],A.[crrf],A.[crrf_kw],A.[csgp],A.[cspa],A.[csqn],A.[cstl],A.[ctcd],A.[ctrj],A.[cubp],A.[cupp],A.[cuqp],A.[cuva],A.[cvat],A.[cvbp],A.[cvpp],A.[cvqp],A.[cwar],A.[damt],A.[ddon],A.[ddta],A.[ddtb],A.[ddtc],A.[ddtd],A.[ddte],A.[ddtf],A.[deleted],A.[dino],A.[disc_1],A.[disc_10],A.[disc_11],A.[disc_2],A.[disc_3],A.[disc_4],A.[disc_5],A.[disc_6],A.[disc_7],A.[disc_8],A.[disc_9],A.[dmde_1],A.[dmde_10],A.[dmde_11],A.[dmde_2],A.[dmde_3],A.[dmde_4],A.[dmde_5],A.[dmde_6],A.[dmde_7],A.[dmde_8],A.[dmde_9],A.[dmse_1],A.[dmse_10],A.[dmse_11],A.[dmse_2],A.[dmse_3],A.[dmse_4],A.[dmse_5],A.[dmse_6],A.[dmse_7],A.[dmse_8],A.[dmse_9],A.[dmth_1],A.[dmth_10],A.[dmth_11],A.[dmth_2],A.[dmth_3],A.[dmth_4],A.[dmth_5],A.[dmth_6],A.[dmth_7],A.[dmth_8],A.[dmth_9],A.[dmth_kw_1],A.[dmth_kw_10],A.[dmth_kw_11],A.[dmth_kw_2],A.[dmth_kw_3],A.[dmth_kw_4],A.[dmth_kw_5],A.[dmth_kw_6],A.[dmth_kw_7],A.[dmth_kw_8],A.[dmth_kw_9],A.[dmty_1],A.[dmty_10],A.[dmty_11],A.[dmty_2],A.[dmty_3],A.[dmty_4],A.[dmty_5],A.[dmty_6],A.[dmty_7],A.[dmty_8],A.[dmty_9],A.[dmty_kw_1],A.[dmty_kw_10],A.[dmty_kw_11],A.[dmty_kw_2],A.[dmty_kw_3],A.[dmty_kw_4],A.[dmty_kw_5],A.[dmty_kw_6],A.[dmty_kw_7],A.[dmty_kw_8],A.[dmty_kw_9],A.[dorg_1],A.[dorg_10],A.[dorg_11],A.[dorg_2],A.[dorg_3],A.[dorg_4],A.[dorg_5],A.[dorg_6],A.[dorg_7],A.[dorg_8],A.[dorg_9],A.[dorg_kw_1],A.[dorg_kw_10],A.[dorg_kw_11],A.[dorg_kw_2],A.[dorg_kw_3],A.[dorg_kw_4],A.[dorg_kw_5],A.[dorg_kw_6],A.[dorg_kw_7],A.[dorg_kw_8],A.[dorg_kw_9],A.[dtrm],A.[dtrm_kw],A.[effn],A.[elgb],A.[elgb_kw],A.[etpc],A.[etpc_kw],A.[exmt],A.[exmt_kw],A.[fire],A.[fire_kw],A.[gefo],A.[gefo_kw],A.[glco],A.[iamt],A.[invd],A.[invn],A.[issp],A.[issp_kw],A.[item],A.[lcam_trnc],A.[lccl],A.[lcrq],A.[lcrq_kw],A.[ldam_1],A.[ldam_10],A.[ldam_11],A.[ldam_2],A.[ldam_3],A.[ldam_4],A.[ldam_5],A.[ldam_6],A.[ldam_7],A.[ldam_8],A.[ldam_9],A.[ldat],A.[leng],A.[lsel],A.[lsel_kw],A.[lseq],A.[mitm],A.[mpnr],A.[mpsn],A.[oamt],A.[odat],A.[oltp],A.[oltp_kw],A.[orno],A.[otbp],A.[ownr],A.[owns],A.[owns_kw],A.[paft],A.[paft_kw],A.[paya],A.[pegd],A.[pegd_kw],A.[pmde],A.[pmnd],A.[pmnd_kw],A.[pmni],A.[pmni_kw],A.[pmnt],A.[pmnt_kw],A.[pmse],A.[pmsk],A.[pono],A.[porg],A.[porg_kw],A.[pric],A.[prsg],A.[pseq],A.[ptpa],A.[ptpe],A.[qbbc],A.[qbbc_buar],A.[qbbc_buln],A.[qbbc_bupc],A.[qbbc_butm],A.[qbbc_buvl],A.[qbbc_buwg],A.[qbbc_invu],A.[qbbc_trnu],A.[qiap],A.[qiap_buar],A.[qiap_buln],A.[qiap_bupc],A.[qiap_butm],A.[qiap_buvl],A.[qiap_buwg],A.[qiap_trnu],A.[qibo],A.[qibo_buar],A.[qibo_buln],A.[qibo_bupc],A.[qibo_butm],A.[qibo_buvl],A.[qibo_buwg],A.[qibo_invu],A.[qibo_trnu],A.[qibp],A.[qidl],A.[qidl_buar],A.[qidl_buln],A.[qidl_bupc],A.[qidl_butm],A.[qidl_buvl],A.[qidl_buwg],A.[qidl_trnu],A.[qiiv],A.[qiiv_buar],A.[qiiv_buln],A.[qiiv_bupc],A.[qiiv_butm],A.[qiiv_buvl],A.[qiiv_buwg],A.[qiiv_trnu],A.[qips],A.[qirj],A.[qirj_buar],A.[qirj_buln],A.[qirj_bupc],A.[qirj_butm],A.[qirj_buvl],A.[qirj_buwg],A.[qirj_trnu],A.[qoor],A.[qoor_buar],A.[qoor_buln],A.[qoor_bupc],A.[qoor_butm],A.[qoor_buvl],A.[qoor_buwg],A.[qoor_invu],A.[qual],A.[qual_kw],A.[rcno],A.[rcod],A.[rdta],A.[revi],A.[rseq],A.[sbim],A.[sbim_kw],A.[sbmt],A.[sdsc],A.[sdsc_kw],A.[serl],A.[serv],A.[sfad],A.[sfbp],A.[sfcn],A.[sfsi],A.[sfwh],A.[site],A.[spcn],A.[sqnb],A.[stdc],A.[stsc],A.[stsc_kw],A.[stsd],A.[stsd_kw],A.[subc],A.[subc_kw],A.[tapr],A.[taxp],A.[taxp_kw],A.[thic],A.[ztimestamp],A.[tpbk],A.[tpbl],A.[txta],A.[vryn],A.[vryn_kw],A.[widt],A.[file_name],A.[dwh_load_time],B.[otad],B.[prno], B.[ccur], B.[crin_kw], B.[ifbp],B.[ccrs],B.[hisp_kw], B.[cvyn_kw],B.[odis],B.[ptad], B.[ptbp], B.[ptcn], B.[plnr],B.[cotp], B.[hdst_kw],
	A.compnr + '_' + Cast(A.orno As Varchar) + '_' + Cast(A.pono As Varchar) + '_' + Cast(A.sqnb As Varchar) As [PU_Order_Lines_fct_key]
	FROM [acq101].[dst_tdpur401] A
	LEFT JOIN (Select Distinct compnr,otad,ctcd,prno,ccur,crin_kw,ifbp,ccrs,hisp_kw,cvyn_kw,odis,ptad,ptbp,ptcn,plnr,orno,cotp,hdst_kw
	FROM [acq101].[dst_tdpur400] Where [deleted] = 'False') B
	ON A.[compnr] = B.[compnr] And A.[orno] = B.[orno]
	Where A.[dwh_load_time] > CASE WHEN (( SELECT count(*) AS count
                                      FROM [dwhcda].[lnc_fct_AP_Pur_Order_Lines])) = 0 THEN convert(datetime,'1900-01-01 00:00:00')
                                      ELSE ( SELECT max(dwh_load_time) FROM [dwhcda].[lnc_fct_AP_Pur_Order_Lines]) END OPTION (LABEL = '[SP_21_AP_Pur_Order_Lines_fct_1]');

	MERGE [dwhcda].[lnc_fct_AP_Pur_Order_Lines] As A
	USING [#ap_PU_Order_Lines] B 
	ON A.[PU_Order_Lines_fct_key] = B.[PU_Order_Lines_fct_key]
	WHEN Matched AND B.[ztimestamp] > A.[ztimestamp] THEN UPDATE SET 
A.[acti]=B.[acti],A.[adin]=B.[adin],A.[akcd]=B.[akcd],A.[amld]=B.[amld],A.[amod]=B.[amod],A.[appr]=B.[appr],A.[appr_kw]=B.[appr_kw],A.[bgrb]=B.[bgrb],A.[bgrb_kw]=B.[bgrb_kw],A.[bgrq]=B.[bgrq],A.[bgrq_kw]=B.[bgrq_kw],A.[bgxc]=B.[bgxc],A.[bgxc_kw]=B.[bgxc_kw],A.[bkyn]=B.[bkyn],A.[bkyn_kw]=B.[bkyn_kw],A.[bpcl]=B.[bpcl],A.[bptc]=B.[bptc],A.[btsp]=B.[btsp],A.[btsp_kw]=B.[btsp_kw],A.[btx1]=B.[btx1],A.[btx2]=B.[btx2],A.[cact]=B.[cact],A.[cadr]=B.[cadr],A.[casi]=B.[casi],A.[ccco]=B.[ccco],A.[ccof]=B.[ccof],A.[ccty]=B.[ccty],A.[cdec]=B.[cdec],A.[cdf_jbtd]=B.[cdf_jbtd],A.[cdis_1]=B.[cdis_1],A.[cdis_10]=B.[cdis_10],A.[cdis_11]=B.[cdis_11],A.[cdis_2]=B.[cdis_2],A.[cdis_3]=B.[cdis_3],A.[cdis_4]=B.[cdis_4],A.[cdis_5]=B.[cdis_5],A.[cdis_6]=B.[cdis_6],A.[cdis_7]=B.[cdis_7],A.[cdis_8]=B.[cdis_8],A.[cdis_9]=B.[cdis_9],A.[ceno]=B.[ceno],A.[cfrw]=B.[cfrw],A.[citt]=B.[citt],A.[clip]=B.[clip],A.[clip_kw]=B.[clip_kw],A.[clot]=B.[clot],A.[clyn]=B.[clyn],A.[clyn_kw]=B.[clyn_kw],A.[cmnf]=B.[cmnf],A.[cncd]=B.[cncd],A.[cnig]=B.[cnig],A.[cnig_kw]=B.[cnig_kw],A.[comm]=B.[comm],A.[comm_kw]=B.[comm_kw],A.[cono]=B.[cono],A.[coop_1]=B.[coop_1],A.[coop_2]=B.[coop_2],A.[coop_3]=B.[coop_3],A.[coop_trnc]=B.[coop_trnc],A.[copr_1]=B.[copr_1],A.[copr_2]=B.[copr_2],A.[copr_3]=B.[copr_3],A.[copr_trnc]=B.[copr_trnc],A.[corg]=B.[corg],A.[corg_kw]=B.[corg_kw],A.[cosn]=B.[cosn],A.[cpay]=B.[cpay],A.[cpcl]=B.[cpcl],A.[cpcp]=B.[cpcp],A.[cpln]=B.[cpln],A.[cpon]=B.[cpon],A.[cprj]=B.[cprj],A.[cpva]=B.[cpva],A.[crbn]=B.[crbn],A.[crbn_kw]=B.[crbn_kw],A.[crcd]=B.[crcd],A.[crej]=B.[crej],A.[crit]=B.[crit],A.[crrf]=B.[crrf],A.[crrf_kw]=B.[crrf_kw],A.[csgp]=B.[csgp],A.[cspa]=B.[cspa],A.[csqn]=B.[csqn],A.[cstl]=B.[cstl],A.[ctcd]=B.[ctcd],A.[ctrj]=B.[ctrj],A.[cubp]=B.[cubp],A.[cupp]=B.[cupp],A.[cuqp]=B.[cuqp],A.[cuva]=B.[cuva],A.[cvat]=B.[cvat],A.[cvbp]=B.[cvbp],A.[cvpp]=B.[cvpp],A.[cvqp]=B.[cvqp],A.[cwar]=B.[cwar],A.[damt]=B.[damt],A.[ddon]=B.[ddon],A.[ddta]=B.[ddta],A.[ddtb]=B.[ddtb],A.[ddtc]=B.[ddtc],A.[ddtd]=B.[ddtd],A.[ddte]=B.[ddte],A.[ddtf]=B.[ddtf],A.[deleted]=B.[deleted],A.[dino]=B.[dino],A.[disc_1]=B.[disc_1],A.[disc_10]=B.[disc_10],A.[disc_11]=B.[disc_11],A.[disc_2]=B.[disc_2],A.[disc_3]=B.[disc_3],A.[disc_4]=B.[disc_4],A.[disc_5]=B.[disc_5],A.[disc_6]=B.[disc_6],A.[disc_7]=B.[disc_7],A.[disc_8]=B.[disc_8],A.[disc_9]=B.[disc_9],A.[dmde_1]=B.[dmde_1],A.[dmde_10]=B.[dmde_10],A.[dmde_11]=B.[dmde_11],A.[dmde_2]=B.[dmde_2],A.[dmde_3]=B.[dmde_3],A.[dmde_4]=B.[dmde_4],A.[dmde_5]=B.[dmde_5],A.[dmde_6]=B.[dmde_6],A.[dmde_7]=B.[dmde_7],A.[dmde_8]=B.[dmde_8],A.[dmde_9]=B.[dmde_9],A.[dmse_1]=B.[dmse_1],A.[dmse_10]=B.[dmse_10],A.[dmse_11]=B.[dmse_11],A.[dmse_2]=B.[dmse_2],A.[dmse_3]=B.[dmse_3],A.[dmse_4]=B.[dmse_4],A.[dmse_5]=B.[dmse_5],A.[dmse_6]=B.[dmse_6],A.[dmse_7]=B.[dmse_7],A.[dmse_8]=B.[dmse_8],A.[dmse_9]=B.[dmse_9],A.[dmth_1]=B.[dmth_1],A.[dmth_10]=B.[dmth_10],A.[dmth_11]=B.[dmth_11],A.[dmth_2]=B.[dmth_2],A.[dmth_3]=B.[dmth_3],A.[dmth_4]=B.[dmth_4],A.[dmth_5]=B.[dmth_5],A.[dmth_6]=B.[dmth_6],A.[dmth_7]=B.[dmth_7],A.[dmth_8]=B.[dmth_8],A.[dmth_9]=B.[dmth_9],A.[dmth_kw_1]=B.[dmth_kw_1],A.[dmth_kw_10]=B.[dmth_kw_10],A.[dmth_kw_11]=B.[dmth_kw_11],A.[dmth_kw_2]=B.[dmth_kw_2],A.[dmth_kw_3]=B.[dmth_kw_3],A.[dmth_kw_4]=B.[dmth_kw_4],A.[dmth_kw_5]=B.[dmth_kw_5],A.[dmth_kw_6]=B.[dmth_kw_6],A.[dmth_kw_7]=B.[dmth_kw_7],A.[dmth_kw_8]=B.[dmth_kw_8],A.[dmth_kw_9]=B.[dmth_kw_9],A.[dmty_1]=B.[dmty_1],A.[dmty_10]=B.[dmty_10],A.[dmty_11]=B.[dmty_11],A.[dmty_2]=B.[dmty_2],A.[dmty_3]=B.[dmty_3],A.[dmty_4]=B.[dmty_4],A.[dmty_5]=B.[dmty_5],A.[dmty_6]=B.[dmty_6],A.[dmty_7]=B.[dmty_7],A.[dmty_8]=B.[dmty_8],A.[dmty_9]=B.[dmty_9],A.[dmty_kw_1]=B.[dmty_kw_1],A.[dmty_kw_10]=B.[dmty_kw_10],A.[dmty_kw_11]=B.[dmty_kw_11],A.[dmty_kw_2]=B.[dmty_kw_2],A.[dmty_kw_3]=B.[dmty_kw_3],A.[dmty_kw_4]=B.[dmty_kw_4],A.[dmty_kw_5]=B.[dmty_kw_5],A.[dmty_kw_6]=B.[dmty_kw_6],A.[dmty_kw_7]=B.[dmty_kw_7],A.[dmty_kw_8]=B.[dmty_kw_8],A.[dmty_kw_9]=B.[dmty_kw_9],A.[dorg_1]=B.[dorg_1],A.[dorg_10]=B.[dorg_10],A.[dorg_11]=B.[dorg_11],A.[dorg_2]=B.[dorg_2],A.[dorg_3]=B.[dorg_3],A.[dorg_4]=B.[dorg_4],A.[dorg_5]=B.[dorg_5],A.[dorg_6]=B.[dorg_6],A.[dorg_7]=B.[dorg_7],A.[dorg_8]=B.[dorg_8],A.[dorg_9]=B.[dorg_9],A.[dorg_kw_1]=B.[dorg_kw_1],A.[dorg_kw_10]=B.[dorg_kw_10],A.[dorg_kw_11]=B.[dorg_kw_11],A.[dorg_kw_2]=B.[dorg_kw_2],A.[dorg_kw_3]=B.[dorg_kw_3],A.[dorg_kw_4]=B.[dorg_kw_4],A.[dorg_kw_5]=B.[dorg_kw_5],A.[dorg_kw_6]=B.[dorg_kw_6],A.[dorg_kw_7]=B.[dorg_kw_7],A.[dorg_kw_8]=B.[dorg_kw_8],A.[dorg_kw_9]=B.[dorg_kw_9],A.[dtrm]=B.[dtrm],A.[dtrm_kw]=B.[dtrm_kw],A.[effn]=B.[effn],A.[elgb]=B.[elgb],A.[elgb_kw]=B.[elgb_kw],A.[etpc]=B.[etpc],A.[etpc_kw]=B.[etpc_kw],A.[exmt]=B.[exmt],A.[exmt_kw]=B.[exmt_kw],A.[fire]=B.[fire],A.[fire_kw]=B.[fire_kw],A.[gefo]=B.[gefo],A.[gefo_kw]=B.[gefo_kw],A.[glco]=B.[glco],A.[iamt]=B.[iamt],A.[invd]=B.[invd],A.[invn]=B.[invn],A.[issp]=B.[issp],A.[issp_kw]=B.[issp_kw],A.[item]=B.[item],A.[lcam_trnc]=B.[lcam_trnc],A.[lccl]=B.[lccl],A.[lcrq]=B.[lcrq],A.[lcrq_kw]=B.[lcrq_kw],A.[ldam_1]=B.[ldam_1],A.[ldam_10]=B.[ldam_10],A.[ldam_11]=B.[ldam_11],A.[ldam_2]=B.[ldam_2],A.[ldam_3]=B.[ldam_3],A.[ldam_4]=B.[ldam_4],A.[ldam_5]=B.[ldam_5],A.[ldam_6]=B.[ldam_6],A.[ldam_7]=B.[ldam_7],A.[ldam_8]=B.[ldam_8],A.[ldam_9]=B.[ldam_9],A.[ldat]=B.[ldat],A.[leng]=B.[leng],A.[lsel]=B.[lsel],A.[lsel_kw]=B.[lsel_kw],A.[lseq]=B.[lseq],A.[mitm]=B.[mitm],A.[mpnr]=B.[mpnr],A.[mpsn]=B.[mpsn],A.[oamt]=B.[oamt],A.[odat]=B.[odat],A.[oltp]=B.[oltp],A.[oltp_kw]=B.[oltp_kw],A.[otbp]=B.[otbp],A.[ownr]=B.[ownr],A.[owns]=B.[owns],A.[owns_kw]=B.[owns_kw],A.[paft]=B.[paft],A.[paft_kw]=B.[paft_kw],A.[paya]=B.[paya],A.[pegd]=B.[pegd],A.[pegd_kw]=B.[pegd_kw],A.[pmde]=B.[pmde],A.[pmnd]=B.[pmnd],A.[pmnd_kw]=B.[pmnd_kw],A.[pmni]=B.[pmni],A.[pmni_kw]=B.[pmni_kw],A.[pmnt]=B.[pmnt],A.[pmnt_kw]=B.[pmnt_kw],A.[pmse]=B.[pmse],A.[pmsk]=B.[pmsk],A.[porg]=B.[porg],A.[porg_kw]=B.[porg_kw],A.[pric]=B.[pric],A.[prsg]=B.[prsg],A.[pseq]=B.[pseq],A.[ptpa]=B.[ptpa],A.[ptpe]=B.[ptpe],A.[qbbc]=B.[qbbc],A.[qbbc_buar]=B.[qbbc_buar],A.[qbbc_buln]=B.[qbbc_buln],A.[qbbc_bupc]=B.[qbbc_bupc],A.[qbbc_butm]=B.[qbbc_butm],A.[qbbc_buvl]=B.[qbbc_buvl],A.[qbbc_buwg]=B.[qbbc_buwg],A.[qbbc_invu]=B.[qbbc_invu],A.[qbbc_trnu]=B.[qbbc_trnu],A.[qiap]=B.[qiap],A.[qiap_buar]=B.[qiap_buar],A.[qiap_buln]=B.[qiap_buln],A.[qiap_bupc]=B.[qiap_bupc],A.[qiap_butm]=B.[qiap_butm],A.[qiap_buvl]=B.[qiap_buvl],A.[qiap_buwg]=B.[qiap_buwg],A.[qiap_trnu]=B.[qiap_trnu],A.[qibo]=B.[qibo],A.[qibo_buar]=B.[qibo_buar],A.[qibo_buln]=B.[qibo_buln],A.[qibo_bupc]=B.[qibo_bupc],A.[qibo_butm]=B.[qibo_butm],A.[qibo_buvl]=B.[qibo_buvl],A.[qibo_buwg]=B.[qibo_buwg],A.[qibo_invu]=B.[qibo_invu],A.[qibo_trnu]=B.[qibo_trnu],A.[qibp]=B.[qibp],A.[qidl]=B.[qidl],A.[qidl_buar]=B.[qidl_buar],A.[qidl_buln]=B.[qidl_buln],A.[qidl_bupc]=B.[qidl_bupc],A.[qidl_butm]=B.[qidl_butm],A.[qidl_buvl]=B.[qidl_buvl],A.[qidl_buwg]=B.[qidl_buwg],A.[qidl_trnu]=B.[qidl_trnu],A.[qiiv]=B.[qiiv],A.[qiiv_buar]=B.[qiiv_buar],A.[qiiv_buln]=B.[qiiv_buln],A.[qiiv_bupc]=B.[qiiv_bupc],A.[qiiv_butm]=B.[qiiv_butm],A.[qiiv_buvl]=B.[qiiv_buvl],A.[qiiv_buwg]=B.[qiiv_buwg],A.[qiiv_trnu]=B.[qiiv_trnu],A.[qips]=B.[qips],A.[qirj]=B.[qirj],A.[qirj_buar]=B.[qirj_buar],A.[qirj_buln]=B.[qirj_buln],A.[qirj_bupc]=B.[qirj_bupc],A.[qirj_butm]=B.[qirj_butm],A.[qirj_buvl]=B.[qirj_buvl],A.[qirj_buwg]=B.[qirj_buwg],A.[qirj_trnu]=B.[qirj_trnu],A.[qoor]=B.[qoor],A.[qoor_buar]=B.[qoor_buar],A.[qoor_buln]=B.[qoor_buln],A.[qoor_bupc]=B.[qoor_bupc],A.[qoor_butm]=B.[qoor_butm],A.[qoor_buvl]=B.[qoor_buvl],A.[qoor_buwg]=B.[qoor_buwg],A.[qoor_invu]=B.[qoor_invu],A.[qual]=B.[qual],A.[qual_kw]=B.[qual_kw],A.[rcno]=B.[rcno],A.[rcod]=B.[rcod],A.[rdta]=B.[rdta],A.[revi]=B.[revi],A.[rseq]=B.[rseq],A.[sbim]=B.[sbim],A.[sbim_kw]=B.[sbim_kw],A.[sbmt]=B.[sbmt],A.[sdsc]=B.[sdsc],A.[sdsc_kw]=B.[sdsc_kw],A.[serl]=B.[serl],A.[serv]=B.[serv],A.[sfad]=B.[sfad],A.[sfbp]=B.[sfbp],A.[sfcn]=B.[sfcn],A.[sfsi]=B.[sfsi],A.[sfwh]=B.[sfwh],A.[site]=B.[site],A.[spcn]=B.[spcn],A.[stdc]=B.[stdc],A.[stsc]=B.[stsc],A.[stsc_kw]=B.[stsc_kw],A.[stsd]=B.[stsd],A.[stsd_kw]=B.[stsd_kw],A.[subc]=B.[subc],A.[subc_kw]=B.[subc_kw],A.[tapr]=B.[tapr],A.[taxp]=B.[taxp],A.[taxp_kw]=B.[taxp_kw],A.[thic]=B.[thic],A.[ztimestamp]=B.[ztimestamp],A.[tpbk]=B.[tpbk],A.[tpbl]=B.[tpbl],A.[txta]=B.[txta],A.[vryn]=B.[vryn],A.[vryn_kw]=B.[vryn_kw],A.[widt]=B.[widt],A.[file_name]=B.[file_name],A.[dwh_load_time]=B.[dwh_load_time],A.[otad]=B.[otad],A.[prno]=B.[prno],A.[ccur]=B.[ccur],A.[crin_kw]=B.[crin_kw],A.[ifbp]=B.[ifbp],A.[ccrs]=B.[ccrs],A.[hisp_kw]=B.[hisp_kw],A.[cvyn_kw]=B.[cvyn_kw],A.[odis]=B.[odis],A.[ptad]=B.[ptad],A.[ptbp]=B.[ptbp],A.[ptcn]=B.[ptcn],A.[plnr]=B.[plnr],A.[cotp]=B.[cotp],A.[hdst_kw]=B.[hdst_kw]
	WHEN NOT MATCHED BY TARGET THEN 
	INSERT ([acti],[adin],[akcd],[amld],[amod],[appr],[appr_kw],[bgrb],[bgrb_kw],[bgrq],[bgrq_kw],[bgxc],[bgxc_kw],[bkyn],[bkyn_kw],[bpcl],[bptc],[btsp],[btsp_kw],[btx1],[btx2],[cact],[cadr],[casi],[ccco],[ccof],[ccty],[cdec],[cdf_jbtd],[cdis_1],[cdis_10],[cdis_11],[cdis_2],[cdis_3],[cdis_4],[cdis_5],[cdis_6],[cdis_7],[cdis_8],[cdis_9],[ceno],[cfrw],[citt],[clip],[clip_kw],[clot],[clyn],[clyn_kw],[cmnf],[cncd],[cnig],[cnig_kw],[comm],[comm_kw],[compnr],[cono],[coop_1],[coop_2],[coop_3],[coop_trnc],[copr_1],[copr_2],[copr_3],[copr_trnc],[corg],[corg_kw],[cosn],[cpay],[cpcl],[cpcp],[cpln],[cpon],[cprj],[cpva],[crbn],[crbn_kw],[crcd],[crej],[crit],[crrf],[crrf_kw],[csgp],[cspa],[csqn],[cstl],[ctcd],[ctrj],[cubp],[cupp],[cuqp],[cuva],[cvat],[cvbp],[cvpp],[cvqp],[cwar],[damt],[ddon],[ddta],[ddtb],[ddtc],[ddtd],[ddte],[ddtf],[deleted],[dino],[disc_1],[disc_10],[disc_11],[disc_2],[disc_3],[disc_4],[disc_5],[disc_6],[disc_7],[disc_8],[disc_9],[dmde_1],[dmde_10],[dmde_11],[dmde_2],[dmde_3],[dmde_4],[dmde_5],[dmde_6],[dmde_7],[dmde_8],[dmde_9],[dmse_1],[dmse_10],[dmse_11],[dmse_2],[dmse_3],[dmse_4],[dmse_5],[dmse_6],[dmse_7],[dmse_8],[dmse_9],[dmth_1],[dmth_10],[dmth_11],[dmth_2],[dmth_3],[dmth_4],[dmth_5],[dmth_6],[dmth_7],[dmth_8],[dmth_9],[dmth_kw_1],[dmth_kw_10],[dmth_kw_11],[dmth_kw_2],[dmth_kw_3],[dmth_kw_4],[dmth_kw_5],[dmth_kw_6],[dmth_kw_7],[dmth_kw_8],[dmth_kw_9],[dmty_1],[dmty_10],[dmty_11],[dmty_2],[dmty_3],[dmty_4],[dmty_5],[dmty_6],[dmty_7],[dmty_8],[dmty_9],[dmty_kw_1],[dmty_kw_10],[dmty_kw_11],[dmty_kw_2],[dmty_kw_3],[dmty_kw_4],[dmty_kw_5],[dmty_kw_6],[dmty_kw_7],[dmty_kw_8],[dmty_kw_9],[dorg_1],[dorg_10],[dorg_11],[dorg_2],[dorg_3],[dorg_4],[dorg_5],[dorg_6],[dorg_7],[dorg_8],[dorg_9],[dorg_kw_1],[dorg_kw_10],[dorg_kw_11],[dorg_kw_2],[dorg_kw_3],[dorg_kw_4],[dorg_kw_5],[dorg_kw_6],[dorg_kw_7],[dorg_kw_8],[dorg_kw_9],[dtrm],[dtrm_kw],[effn],[elgb],[elgb_kw],[etpc],[etpc_kw],[exmt],[exmt_kw],[fire],[fire_kw],[gefo],[gefo_kw],[glco],[iamt],[invd],[invn],[issp],[issp_kw],[item],[lcam_trnc],[lccl],[lcrq],[lcrq_kw],[ldam_1],[ldam_10],[ldam_11],[ldam_2],[ldam_3],[ldam_4],[ldam_5],[ldam_6],[ldam_7],[ldam_8],[ldam_9],[ldat],[leng],[lsel],[lsel_kw],[lseq],[mitm],[mpnr],[mpsn],[oamt],[odat],[oltp],[oltp_kw],[orno],[otbp],[ownr],[owns],[owns_kw],[paft],[paft_kw],[paya],[pegd],[pegd_kw],[pmde],[pmnd],[pmnd_kw],[pmni],[pmni_kw],[pmnt],[pmnt_kw],[pmse],[pmsk],[pono],[porg],[porg_kw],[pric],[prsg],[pseq],[ptpa],[ptpe],[qbbc],[qbbc_buar],[qbbc_buln],[qbbc_bupc],[qbbc_butm],[qbbc_buvl],[qbbc_buwg],[qbbc_invu],[qbbc_trnu],[qiap],[qiap_buar],[qiap_buln],[qiap_bupc],[qiap_butm],[qiap_buvl],[qiap_buwg],[qiap_trnu],[qibo],[qibo_buar],[qibo_buln],[qibo_bupc],[qibo_butm],[qibo_buvl],[qibo_buwg],[qibo_invu],[qibo_trnu],[qibp],[qidl],[qidl_buar],[qidl_buln],[qidl_bupc],[qidl_butm],[qidl_buvl],[qidl_buwg],[qidl_trnu],[qiiv],[qiiv_buar],[qiiv_buln],[qiiv_bupc],[qiiv_butm],[qiiv_buvl],[qiiv_buwg],[qiiv_trnu],[qips],[qirj],[qirj_buar],[qirj_buln],[qirj_bupc],[qirj_butm],[qirj_buvl],[qirj_buwg],[qirj_trnu],[qoor],[qoor_buar],[qoor_buln],[qoor_bupc],[qoor_butm],[qoor_buvl],[qoor_buwg],[qoor_invu],[qual],[qual_kw],[rcno],[rcod],[rdta],[revi],[rseq],[sbim],[sbim_kw],[sbmt],[sdsc],[sdsc_kw],[serl],[serv],[sfad],[sfbp],[sfcn],[sfsi],[sfwh],[site],[spcn],[sqnb],[stdc],[stsc],[stsc_kw],[stsd],[stsd_kw],[subc],[subc_kw],[tapr],[taxp],[taxp_kw],[thic],[ztimestamp],[tpbk],[tpbl],[txta],[vryn],[vryn_kw],[widt],[file_name],[dwh_load_time],[otad],[prno],[ccur],[crin_kw],[ifbp],[ccrs],[hisp_kw],[cvyn_kw],[odis],[ptad],[ptbp],[ptcn],[plnr],[cotp],[hdst_kw],[PU_Order_Lines_fct_key])
	VALUES
	(B.[acti],B.[adin],B.[akcd],B.[amld],B.[amod],B.[appr],B.[appr_kw],B.[bgrb],B.[bgrb_kw],B.[bgrq],B.[bgrq_kw],B.[bgxc],B.[bgxc_kw],B.[bkyn],B.[bkyn_kw],B.[bpcl],B.[bptc],B.[btsp],B.[btsp_kw],B.[btx1],B.[btx2],B.[cact],B.[cadr],B.[casi],B.[ccco],B.[ccof],B.[ccty],B.[cdec],B.[cdf_jbtd],B.[cdis_1],B.[cdis_10],B.[cdis_11],B.[cdis_2],B.[cdis_3],B.[cdis_4],B.[cdis_5],B.[cdis_6],B.[cdis_7],B.[cdis_8],B.[cdis_9],B.[ceno],B.[cfrw],B.[citt],B.[clip],B.[clip_kw],B.[clot],B.[clyn],B.[clyn_kw],B.[cmnf],B.[cncd],B.[cnig],B.[cnig_kw],B.[comm],B.[comm_kw],B.[compnr],B.[cono],B.[coop_1],B.[coop_2],B.[coop_3],B.[coop_trnc],B.[copr_1],B.[copr_2],B.[copr_3],B.[copr_trnc],B.[corg],B.[corg_kw],B.[cosn],B.[cpay],B.[cpcl],B.[cpcp],B.[cpln],B.[cpon],B.[cprj],B.[cpva],B.[crbn],B.[crbn_kw],B.[crcd],B.[crej],B.[crit],B.[crrf],B.[crrf_kw],B.[csgp],B.[cspa],B.[csqn],B.[cstl],B.[ctcd],B.[ctrj],B.[cubp],B.[cupp],B.[cuqp],B.[cuva],B.[cvat],B.[cvbp],B.[cvpp],B.[cvqp],B.[cwar],B.[damt],B.[ddon],B.[ddta],B.[ddtb],B.[ddtc],B.[ddtd],B.[ddte],B.[ddtf],B.[deleted],B.[dino],B.[disc_1],B.[disc_10],B.[disc_11],B.[disc_2],B.[disc_3],B.[disc_4],B.[disc_5],B.[disc_6],B.[disc_7],B.[disc_8],B.[disc_9],B.[dmde_1],B.[dmde_10],B.[dmde_11],B.[dmde_2],B.[dmde_3],B.[dmde_4],B.[dmde_5],B.[dmde_6],B.[dmde_7],B.[dmde_8],B.[dmde_9],B.[dmse_1],B.[dmse_10],B.[dmse_11],B.[dmse_2],B.[dmse_3],B.[dmse_4],B.[dmse_5],B.[dmse_6],B.[dmse_7],B.[dmse_8],B.[dmse_9],B.[dmth_1],B.[dmth_10],B.[dmth_11],B.[dmth_2],B.[dmth_3],B.[dmth_4],B.[dmth_5],B.[dmth_6],B.[dmth_7],B.[dmth_8],B.[dmth_9],B.[dmth_kw_1],B.[dmth_kw_10],B.[dmth_kw_11],B.[dmth_kw_2],B.[dmth_kw_3],B.[dmth_kw_4],B.[dmth_kw_5],B.[dmth_kw_6],B.[dmth_kw_7],B.[dmth_kw_8],B.[dmth_kw_9],B.[dmty_1],B.[dmty_10],B.[dmty_11],B.[dmty_2],B.[dmty_3],B.[dmty_4],B.[dmty_5],B.[dmty_6],B.[dmty_7],B.[dmty_8],B.[dmty_9],B.[dmty_kw_1],B.[dmty_kw_10],B.[dmty_kw_11],B.[dmty_kw_2],B.[dmty_kw_3],B.[dmty_kw_4],B.[dmty_kw_5],B.[dmty_kw_6],B.[dmty_kw_7],B.[dmty_kw_8],B.[dmty_kw_9],B.[dorg_1],B.[dorg_10],B.[dorg_11],B.[dorg_2],B.[dorg_3],B.[dorg_4],B.[dorg_5],B.[dorg_6],B.[dorg_7],B.[dorg_8],B.[dorg_9],B.[dorg_kw_1],B.[dorg_kw_10],B.[dorg_kw_11],B.[dorg_kw_2],B.[dorg_kw_3],B.[dorg_kw_4],B.[dorg_kw_5],B.[dorg_kw_6],B.[dorg_kw_7],B.[dorg_kw_8],B.[dorg_kw_9],B.[dtrm],B.[dtrm_kw],B.[effn],B.[elgb],B.[elgb_kw],B.[etpc],B.[etpc_kw],B.[exmt],B.[exmt_kw],B.[fire],B.[fire_kw],B.[gefo],B.[gefo_kw],B.[glco],B.[iamt],B.[invd],B.[invn],B.[issp],B.[issp_kw],B.[item],B.[lcam_trnc],B.[lccl],B.[lcrq],B.[lcrq_kw],B.[ldam_1],B.[ldam_10],B.[ldam_11],B.[ldam_2],B.[ldam_3],B.[ldam_4],B.[ldam_5],B.[ldam_6],B.[ldam_7],B.[ldam_8],B.[ldam_9],B.[ldat],B.[leng],B.[lsel],B.[lsel_kw],B.[lseq],B.[mitm],B.[mpnr],B.[mpsn],B.[oamt],B.[odat],B.[oltp],B.[oltp_kw],B.[orno],B.[otbp],B.[ownr],B.[owns],B.[owns_kw],B.[paft],B.[paft_kw],B.[paya],B.[pegd],B.[pegd_kw],B.[pmde],B.[pmnd],B.[pmnd_kw],B.[pmni],B.[pmni_kw],B.[pmnt],B.[pmnt_kw],B.[pmse],B.[pmsk],B.[pono],B.[porg],B.[porg_kw],B.[pric],B.[prsg],B.[pseq],B.[ptpa],B.[ptpe],B.[qbbc],B.[qbbc_buar],B.[qbbc_buln],B.[qbbc_bupc],B.[qbbc_butm],B.[qbbc_buvl],B.[qbbc_buwg],B.[qbbc_invu],B.[qbbc_trnu],B.[qiap],B.[qiap_buar],B.[qiap_buln],B.[qiap_bupc],B.[qiap_butm],B.[qiap_buvl],B.[qiap_buwg],B.[qiap_trnu],B.[qibo],B.[qibo_buar],B.[qibo_buln],B.[qibo_bupc],B.[qibo_butm],B.[qibo_buvl],B.[qibo_buwg],B.[qibo_invu],B.[qibo_trnu],B.[qibp],B.[qidl],B.[qidl_buar],B.[qidl_buln],B.[qidl_bupc],B.[qidl_butm],B.[qidl_buvl],B.[qidl_buwg],B.[qidl_trnu],B.[qiiv],B.[qiiv_buar],B.[qiiv_buln],B.[qiiv_bupc],B.[qiiv_butm],B.[qiiv_buvl],B.[qiiv_buwg],B.[qiiv_trnu],B.[qips],B.[qirj],B.[qirj_buar],B.[qirj_buln],B.[qirj_bupc],B.[qirj_butm],B.[qirj_buvl],B.[qirj_buwg],B.[qirj_trnu],B.[qoor],B.[qoor_buar],B.[qoor_buln],B.[qoor_bupc],B.[qoor_butm],B.[qoor_buvl],B.[qoor_buwg],B.[qoor_invu],B.[qual],B.[qual_kw],B.[rcno],B.[rcod],B.[rdta],B.[revi],B.[rseq],B.[sbim],B.[sbim_kw],B.[sbmt],B.[sdsc],B.[sdsc_kw],B.[serl],B.[serv],B.[sfad],B.[sfbp],B.[sfcn],B.[sfsi],B.[sfwh],B.[site],B.[spcn],B.[sqnb],B.[stdc],B.[stsc],B.[stsc_kw],B.[stsd],B.[stsd_kw],B.[subc],B.[subc_kw],B.[tapr],B.[taxp],B.[taxp_kw],B.[thic],B.[ztimestamp],B.[tpbk],B.[tpbl],B.[txta],B.[vryn],B.[vryn_kw],B.[widt],B.[file_name],B.[dwh_load_time],B.[otad],B.[prno],B.[ccur],B.[crin_kw],B.[ifbp],B.[ccrs],B.[hisp_kw],B.[cvyn_kw],B.[odis],B.[ptad],B.[ptbp],B.[ptcn],B.[plnr],B.[cotp],B.[hdst_kw],B.[PU_Order_Lines_fct_key])
	OPTION (LABEL = '[SP_21_AP_Pur_Order_Lines_fct_8]');

									  
	END TRY

	BEGIN CATCH
		IF @@TRANCOUNT > 0
			ROLLBACK TRANSACTION;
		ELSE
			COMMIT TRANSACTION;

		DECLARE @ErrorMessage NVARCHAR(4000);
		DECLARE @ErrorSeverity INT;
		DECLARE @ErrorState INT;

		SELECT @ErrorMessage = ERROR_MESSAGE();

		SELECT @ErrorSeverity = ERROR_SEVERITY();

		SELECT @ErrorState = ERROR_STATE();

		RAISERROR (
				@ErrorMessage
				,@ErrorSeverity
				,@ErrorState
				);
	END CATCH

	COMMIT TRANSACTION;
END;
GO


