CREATE PROC [dwhcda].[SP_22_AP_Pur_Order_Line_History_fct] AS
BEGIN

	SET NOCOUNT ON;
	
	IF OBJECT_ID('tempdb..[#ap_PU_Order_Line_History]', 'U') IS NOT NULL
	DROP TABLE #ap_PU_Order_Line_History

    Select * INTO [#ap_PU_Order_Line_History]    
	From [dwhcda].[lnc_fct_AP_Pur_Order_Line_History] where 1 = 2;

	BEGIN TRANSACTION;

	BEGIN TRY
		
--Purchase Order Line History
	Insert into #ap_PU_Order_Line_History
	( [acti],[adin],[akcd],[amld],[amod],[amta],[appr],[appr_kw],[asno],[bgrb],[bgrb_kw],[bgrq],[bgrq_kw],[bgxc],[bgxc_kw],[bkyn],[bkyn_kw],[bpcl],
[bptc],[btsp],[btsp_kw],[btx1],[btx2],[cact],[cadr],[casi],[ccco],[ccof],[ccty],[cdec],[cdis_1],[cdis_10],[cdis_11],[cdis_2],[cdis_3],[cdis_4],[cdis_5],[cdis_6],[cdis_7],[cdis_8],[cdis_9],[ceno],[cfap],[cfap_kw],[cfrw],[citg],[citt],[ckor],[ckor_kw],[clip],[clip_kw],[clot],[clyn],[clyn_kw],[cmnf],[cncd],[cnig],[cnig_kw],[cnpt],[cnpt_kw],[comm],[comm_kw],[compnr],[cono],[coop_1],[coop_2],[coop_3],[copr_1],[copr_2],[copr_3],[corg],[corg_kw],[cosn],[cpay],[cpcl],[cpcp],[cpgp],[cpln],[cprj],[cpva],[crbn],[crbn_kw],[crcd],[crej],[crit],[crrf],[crrf_kw],[csgp],[cspa],[csqn],[cstl],[ctcd],[ctrj],[cubp],[cucf],[cumr],[cupp],[cuqp],[curq],[cuva],[cvat],[cvbp],[cvcf],[cvmr],[cvpp],[cvqp],[cvrq],[cwar],[damt],[ddon],[ddta],[ddtb],[ddtc],[ddtd],[ddte],[ddtf],[deleted],[dino],[disc_1],[disc_10],[disc_11],[disc_2],[disc_3],[disc_4],[disc_5],[disc_6],[disc_7],[disc_8],[disc_9],[dmde_1],[dmde_10],[dmde_11],[dmde_2],[dmde_3],[dmde_4],[dmde_5],[dmde_6],[dmde_7],[dmde_8],[dmde_9],[dmse_1],[dmse_10],[dmse_11],[dmse_2],[dmse_3],[dmse_4],[dmse_5],[dmse_6],[dmse_7],[dmse_8],[dmse_9],[dmth_1],[dmth_10],[dmth_11],[dmth_2],[dmth_3],[dmth_4],[dmth_5],[dmth_6],[dmth_7],[dmth_8],[dmth_9],[dmth_kw_1],[dmth_kw_10],[dmth_kw_11],[dmth_kw_2],[dmth_kw_3],[dmth_kw_4],[dmth_kw_5],[dmth_kw_6],[dmth_kw_7],[dmth_kw_8],[dmth_kw_9],[dmty_1],[dmty_10],[dmty_11],[dmty_2],[dmty_3],[dmty_4],[dmty_5],[dmty_6],[dmty_7],[dmty_8],[dmty_9],[dmty_kw_1],[dmty_kw_10],[dmty_kw_11],[dmty_kw_2],[dmty_kw_3],[dmty_kw_4],[dmty_kw_5],[dmty_kw_6],[dmty_kw_7],[dmty_kw_8],[dmty_kw_9],[dorg_1],[dorg_10],[dorg_11],[dorg_2],[dorg_3],[dorg_4],[dorg_5],[dorg_6],[dorg_7],[dorg_8],[dorg_9],[dorg_kw_1],[dorg_kw_10],[dorg_kw_11],[dorg_kw_2],[dorg_kw_3],[dorg_kw_4],[dorg_kw_5],[dorg_kw_6],[dorg_kw_7],[dorg_kw_8],[dorg_kw_9],[dtrm],[dtrm_kw],[effn],[elgb],[elgb_kw],[etpc],[etpc_kw],[exmt],[exmt_kw],[fire],[fire_kw],[fono],[fopo],[gefo],[gefo_kw],[glco],[hisa],[hisa_kw],[iamt],[invc],[invc_kw],[invd],[invn],[issp],[issp_kw],[item],[iwgt],[iwun],[kitm],[kitm_kw],[lccl],[lcrq],[lcrq_kw],[ldam_1],[ldam_10],[ldam_11],[ldam_2],[ldam_3],[ldam_4],[ldam_5],[ldam_6],[ldam_7],[ldam_8],[ldam_9],[ldat],[leng],[logn],[lsel],[lsel_kw],[lseq],[lsid],[lstn],[manp],[manp_kw],[mitm],[mnlp],[mnsq],[mnwo],[mpnr],[mpsn],[mrdt],[oamt],[odat],[odno],[odty],[odty_kw],[oltp],[oltp_kw],[oorn],[opno],[opon],[orno],[osqn],[otbp],[owno],[ownr],[owns],[owns_kw],[paft],[paft_kw],[paya],[pcsr],[pcsr_kw],[pdno],[pegd],[pegd_kw],[pgmd],[pgmd_kw],[pmde],[pmnd],[pmnd_kw],[pmni],[pmni_kw],[pmnt],[pmnt_kw],[pmse],[pmsk],[pono],[porg],[porg_kw],[posi],[ppon],[pric],[prsg],[prtp],[pseq],[ptpa],[ptpe],[qalt],[qbbc],[qccf],[qiap],[qibo],[qibp],[qidl],[qiiv],[qilh],[qips],[qirj],[qish],[qmmr],[qono],[qoor],[qpon],[qrrq],[qseq],[qual],[qual_kw],[rcod],[rdta],[refs],[rels],[rels_kw],[reno],[reto],[retp],[rets],[revi],[revn],[rqno],[rqpo],[rqtp],[rqtp_kw],[rseq],[rtyn],[rtyn_kw],[rtyp],[rtyp_kw],[sbim],[sbim_kw],[sbmt],[schu],[schu_kw],[sctp],[sctp_kw],[sdsc],[sdsc_kw],[serl],[sern],[serv],[sfad],[sfbp],[sfcn],[sfsi],[sfwh],[shdt],[site],[sorn],[spcn],[spon],[sqnb],[srpo],[srsq],[srvo],[sseq],[stat],[stat_kw],[stcd],[stcd_kw],[stdc],[stsc],[stsc_kw],[stsd],[stsd_kw],[styp],[styp_kw],[subc],[subc_kw],[tapr],[taxp],[taxp_kw],[thic],[ztimestamp],[tpbk],[tpbl],[trdt],[txta],[vrpr],[vrpr_kw],[widt],[file_name],[dwh_load_time],[otad],[prno],[ccur],[crin_kw],[ifbp],[ccrs],[hisp_kw],[cvyn_kw],[odis],[ptad],[ptbp],[ptcn],[plnr],[cotp],[hdst_kw],[PU_Order_Line_His_fct_key])
	SELECT A.[acti],A.[adin],A.[akcd],A.[amld],A.[amod],A.[amta],A.[appr],A.[appr_kw],A.[asno],A.[bgrb],A.[bgrb_kw],A.[bgrq],A.[bgrq_kw],A.[bgxc],A.[bgxc_kw],A.[bkyn],A.[bkyn_kw],
	A.[bpcl],A.[bptc],A.[btsp],A.[btsp_kw],A.[btx1],A.[btx2],A.[cact],A.[cadr],A.[casi],A.[ccco],A.[ccof],A.[ccty],A.[cdec],A.[cdis_1],A.[cdis_10],A.[cdis_11],A.[cdis_2],A.[cdis_3],A.[cdis_4],A.[cdis_5],A.[cdis_6],A.[cdis_7],A.[cdis_8],A.[cdis_9],A.[ceno],A.[cfap],A.[cfap_kw],A.[cfrw],A.[citg],A.[citt],A.[ckor],A.[ckor_kw],A.[clip],A.[clip_kw],A.[clot],A.[clyn],A.[clyn_kw],A.[cmnf],A.[cncd],A.[cnig],A.[cnig_kw],A.[cnpt],A.[cnpt_kw],A.[comm],A.[comm_kw],A.[compnr],A.[cono],A.[coop_1],A.[coop_2],A.[coop_3],A.[copr_1],A.[copr_2],A.[copr_3],A.[corg],A.[corg_kw],A.[cosn],A.[cpay],A.[cpcl],A.[cpcp],A.[cpgp],A.[cpln],A.[cprj],A.[cpva],A.[crbn],A.[crbn_kw],A.[crcd],A.[crej],A.[crit],A.[crrf],A.[crrf_kw],A.[csgp],A.[cspa],A.[csqn],A.[cstl],A.[ctcd],A.[ctrj],A.[cubp],A.[cucf],A.[cumr],A.[cupp],A.[cuqp],A.[curq],A.[cuva],A.[cvat],A.[cvbp],A.[cvcf],A.[cvmr],A.[cvpp],A.[cvqp],A.[cvrq],A.[cwar],A.[damt],A.[ddon],A.[ddta],A.[ddtb],A.[ddtc],A.[ddtd],A.[ddte],A.[ddtf],A.[deleted],A.[dino],A.[disc_1],A.[disc_10],A.[disc_11],A.[disc_2],A.[disc_3],A.[disc_4],A.[disc_5],A.[disc_6],A.[disc_7],A.[disc_8],A.[disc_9],A.[dmde_1],A.[dmde_10],A.[dmde_11],A.[dmde_2],A.[dmde_3],A.[dmde_4],A.[dmde_5],A.[dmde_6],A.[dmde_7],A.[dmde_8],A.[dmde_9],A.[dmse_1],A.[dmse_10],A.[dmse_11],A.[dmse_2],A.[dmse_3],A.[dmse_4],A.[dmse_5],A.[dmse_6],A.[dmse_7],A.[dmse_8],A.[dmse_9],A.[dmth_1],A.[dmth_10],A.[dmth_11],A.[dmth_2],A.[dmth_3],A.[dmth_4],A.[dmth_5],A.[dmth_6],A.[dmth_7],A.[dmth_8],A.[dmth_9],A.[dmth_kw_1],A.[dmth_kw_10],A.[dmth_kw_11],A.[dmth_kw_2],A.[dmth_kw_3],A.[dmth_kw_4],A.[dmth_kw_5],A.[dmth_kw_6],A.[dmth_kw_7],A.[dmth_kw_8],A.[dmth_kw_9],A.[dmty_1],A.[dmty_10],A.[dmty_11],A.[dmty_2],A.[dmty_3],A.[dmty_4],A.[dmty_5],A.[dmty_6],A.[dmty_7],A.[dmty_8],A.[dmty_9],A.[dmty_kw_1],A.[dmty_kw_10],A.[dmty_kw_11],A.[dmty_kw_2],A.[dmty_kw_3],A.[dmty_kw_4],A.[dmty_kw_5],A.[dmty_kw_6],A.[dmty_kw_7],A.[dmty_kw_8],A.[dmty_kw_9],A.[dorg_1],A.[dorg_10],A.[dorg_11],A.[dorg_2],A.[dorg_3],A.[dorg_4],A.[dorg_5],A.[dorg_6],A.[dorg_7],A.[dorg_8],A.[dorg_9],A.[dorg_kw_1],A.[dorg_kw_10],A.[dorg_kw_11],A.[dorg_kw_2],A.[dorg_kw_3],A.[dorg_kw_4],A.[dorg_kw_5],A.[dorg_kw_6],A.[dorg_kw_7],A.[dorg_kw_8],A.[dorg_kw_9],A.[dtrm],A.[dtrm_kw],A.[effn],A.[elgb],A.[elgb_kw],A.[etpc],A.[etpc_kw],A.[exmt],A.[exmt_kw],A.[fire],A.[fire_kw],A.[fono],A.[fopo],A.[gefo],A.[gefo_kw],A.[glco],A.[hisa],A.[hisa_kw],A.[iamt],A.[invc],A.[invc_kw],A.[invd],A.[invn],A.[issp],A.[issp_kw],A.[item],A.[iwgt],A.[iwun],A.[kitm],A.[kitm_kw],A.[lccl],A.[lcrq],A.[lcrq_kw],A.[ldam_1],A.[ldam_10],A.[ldam_11],A.[ldam_2],A.[ldam_3],A.[ldam_4],A.[ldam_5],A.[ldam_6],A.[ldam_7],A.[ldam_8],A.[ldam_9],A.[ldat],A.[leng],A.[logn],A.[lsel],A.[lsel_kw],A.[lseq],A.[lsid],A.[lstn],A.[manp],A.[manp_kw],A.[mitm],A.[mnlp],A.[mnsq],A.[mnwo],A.[mpnr],A.[mpsn],A.[mrdt],A.[oamt],A.[odat],A.[odno],A.[odty],A.[odty_kw],A.[oltp],A.[oltp_kw],A.[oorn],A.[opno],A.[opon],A.[orno],A.[osqn],A.[otbp],A.[owno],A.[ownr],A.[owns],A.[owns_kw],A.[paft],A.[paft_kw],A.[paya],A.[pcsr],A.[pcsr_kw],A.[pdno],A.[pegd],A.[pegd_kw],A.[pgmd],A.[pgmd_kw],A.[pmde],A.[pmnd],A.[pmnd_kw],A.[pmni],A.[pmni_kw],A.[pmnt],A.[pmnt_kw],A.[pmse],A.[pmsk],A.[pono],A.[porg],A.[porg_kw],A.[posi],A.[ppon],A.[pric],A.[prsg],A.[prtp],A.[pseq],A.[ptpa],A.[ptpe],A.[qalt],A.[qbbc],A.[qccf],A.[qiap],A.[qibo],A.[qibp],A.[qidl],A.[qiiv],A.[qilh],A.[qips],A.[qirj],A.[qish],A.[qmmr],A.[qono],A.[qoor],A.[qpon],A.[qrrq],A.[qseq],A.[qual],A.[qual_kw],A.[rcod],A.[rdta],A.[refs],A.[rels],A.[rels_kw],A.[reno],A.[reto],A.[retp],A.[rets],A.[revi],A.[revn],A.[rqno],A.[rqpo],A.[rqtp],A.[rqtp_kw],A.[rseq],A.[rtyn],A.[rtyn_kw],A.[rtyp],A.[rtyp_kw],A.[sbim],A.[sbim_kw],A.[sbmt],A.[schu],A.[schu_kw],A.[sctp],A.[sctp_kw],A.[sdsc],A.[sdsc_kw],A.[serl],A.[sern],A.[serv],A.[sfad],A.[sfbp],A.[sfcn],A.[sfsi],A.[sfwh],A.[shdt],A.[site],A.[sorn],A.[spcn],A.[spon],A.[sqnb],A.[srpo],A.[srsq],A.[srvo],A.[sseq],A.[stat],A.[stat_kw],A.[stcd],A.[stcd_kw],A.[stdc],A.[stsc],A.[stsc_kw],A.[stsd],A.[stsd_kw],A.[styp],A.[styp_kw],A.[subc],A.[subc_kw],A.[tapr],A.[taxp],A.[taxp_kw],A.[thic],A.[ztimestamp],A.[tpbk],A.[tpbl],A.[trdt],A.[txta],A.[vrpr],A.[vrpr_kw],A.[widt],A.[file_name],A.[dwh_load_time],B.[otad],B.[prno], B.[ccur], B.[crin_kw], B.[ifbp],B.[ccrs],B.[hisp_kw], B.[cvyn_kw],B.[odis],B.[ptad], B.[ptbp], B.[ptcn], B.[plnr],B.[cotp], B.[hdst_kw],A.compnr + '_' +Cast(A.ckor As Varchar) + '_' + Cast(A.orno As Varchar) + '_' + Cast(A.pono As Varchar) + '_' +Cast(A.sern As Varchar) + '_' + Cast(A.sqnb As Varchar)+ '_' + CONVERT(NVARCHAR,A.trdt, 21) As [PU_Order_Line_His_fct_key]
	FROM [acq101].[dst_tdpur451] A
	LEFT JOIN (Select Distinct compnr,otad,ctcd,prno,ccur,crin_kw,ifbp,ccrs,hisp_kw,cvyn_kw,odis,ptad,ptbp,ptcn,plnr,orno,cotp,hdst_kw
	FROM [acq101].[dst_tdpur400] Where [deleted] = 'False') B
	ON A.[compnr] = B.[compnr] And A.[orno] = B.[orno]
	Where A.[dwh_load_time] > CASE WHEN (( SELECT count(*) AS count
                                      FROM [dwhcda].[lnc_fct_AP_Pur_Order_Line_History])) = 0 THEN convert(datetime,'1900-01-01 00:00:00')
                                      ELSE ( SELECT max(dwh_load_time) FROM [dwhcda].[lnc_fct_AP_Pur_Order_Line_History]) END OPTION (LABEL = '[SP_22_AP_Pur_Order_Line_History_fct_1]');

	MERGE [dwhcda].[lnc_fct_AP_Pur_Order_Line_History] As A
	USING [#ap_PU_Order_Line_History] B 
	ON A.[PU_Order_Line_His_fct_key] = B.[PU_Order_Line_His_fct_key]
	WHEN Matched AND B.[ztimestamp] > A.[ztimestamp] THEN UPDATE SET 
A.[acti]=B.[acti],A.[adin]=B.[adin],A.[akcd]=B.[akcd],A.[amld]=B.[amld],A.[amod]=B.[amod],A.[amta]=B.[amta],A.[appr]=B.[appr],A.[appr_kw]=B.[appr_kw],A.[asno]=B.[asno],A.[bgrb]=B.[bgrb],A.[bgrb_kw]=B.[bgrb_kw],A.[bgrq]=B.[bgrq],A.[bgrq_kw]=B.[bgrq_kw],A.[bgxc]=B.[bgxc],A.[bgxc_kw]=B.[bgxc_kw],A.[bkyn]=B.[bkyn],A.[bkyn_kw]=B.[bkyn_kw],A.[bpcl]=B.[bpcl],A.[bptc]=B.[bptc],A.[btsp]=B.[btsp],A.[btsp_kw]=B.[btsp_kw],A.[btx1]=B.[btx1],A.[btx2]=B.[btx2],A.[cact]=B.[cact],A.[cadr]=B.[cadr],A.[casi]=B.[casi],A.[ccco]=B.[ccco],A.[ccof]=B.[ccof],A.[ccty]=B.[ccty],A.[cdec]=B.[cdec],A.[cdis_1]=B.[cdis_1],A.[cdis_10]=B.[cdis_10],A.[cdis_11]=B.[cdis_11],A.[cdis_2]=B.[cdis_2],A.[cdis_3]=B.[cdis_3],A.[cdis_4]=B.[cdis_4],A.[cdis_5]=B.[cdis_5],A.[cdis_6]=B.[cdis_6],A.[cdis_7]=B.[cdis_7],A.[cdis_8]=B.[cdis_8],A.[cdis_9]=B.[cdis_9],A.[ceno]=B.[ceno],A.[cfap]=B.[cfap],A.[cfap_kw]=B.[cfap_kw],A.[cfrw]=B.[cfrw],A.[citg]=B.[citg],A.[citt]=B.[citt],A.[ckor_kw]=B.[ckor_kw],A.[clip]=B.[clip],A.[clip_kw]=B.[clip_kw],A.[clot]=B.[clot],A.[clyn]=B.[clyn],A.[clyn_kw]=B.[clyn_kw],A.[cmnf]=B.[cmnf],A.[cncd]=B.[cncd],A.[cnig]=B.[cnig],A.[cnig_kw]=B.[cnig_kw],A.[cnpt]=B.[cnpt],A.[cnpt_kw]=B.[cnpt_kw],A.[comm]=B.[comm],A.[comm_kw]=B.[comm_kw],A.[cono]=B.[cono],A.[coop_1]=B.[coop_1],A.[coop_2]=B.[coop_2],A.[coop_3]=B.[coop_3],A.[copr_1]=B.[copr_1],A.[copr_2]=B.[copr_2],A.[copr_3]=B.[copr_3],A.[corg]=B.[corg],A.[corg_kw]=B.[corg_kw],A.[cosn]=B.[cosn],A.[cpay]=B.[cpay],A.[cpcl]=B.[cpcl],A.[cpcp]=B.[cpcp],A.[cpgp]=B.[cpgp],A.[cpln]=B.[cpln],A.[cprj]=B.[cprj],A.[cpva]=B.[cpva],A.[crbn]=B.[crbn],A.[crbn_kw]=B.[crbn_kw],A.[crcd]=B.[crcd],A.[crej]=B.[crej],A.[crit]=B.[crit],A.[crrf]=B.[crrf],A.[crrf_kw]=B.[crrf_kw],A.[csgp]=B.[csgp],A.[cspa]=B.[cspa],A.[csqn]=B.[csqn],A.[cstl]=B.[cstl],A.[ctcd]=B.[ctcd],A.[ctrj]=B.[ctrj],A.[cubp]=B.[cubp],A.[cucf]=B.[cucf],A.[cumr]=B.[cumr],A.[cupp]=B.[cupp],A.[cuqp]=B.[cuqp],A.[curq]=B.[curq],A.[cuva]=B.[cuva],A.[cvat]=B.[cvat],A.[cvbp]=B.[cvbp],A.[cvcf]=B.[cvcf],A.[cvmr]=B.[cvmr],A.[cvpp]=B.[cvpp],A.[cvqp]=B.[cvqp],A.[cvrq]=B.[cvrq],A.[cwar]=B.[cwar],A.[damt]=B.[damt],A.[ddon]=B.[ddon],A.[ddta]=B.[ddta],A.[ddtb]=B.[ddtb],A.[ddtc]=B.[ddtc],A.[ddtd]=B.[ddtd],A.[ddte]=B.[ddte],A.[ddtf]=B.[ddtf],A.[deleted]=B.[deleted],A.[dino]=B.[dino],A.[disc_1]=B.[disc_1],A.[disc_10]=B.[disc_10],A.[disc_11]=B.[disc_11],A.[disc_2]=B.[disc_2],A.[disc_3]=B.[disc_3],A.[disc_4]=B.[disc_4],A.[disc_5]=B.[disc_5],A.[disc_6]=B.[disc_6],A.[disc_7]=B.[disc_7],A.[disc_8]=B.[disc_8],A.[disc_9]=B.[disc_9],A.[dmde_1]=B.[dmde_1],A.[dmde_10]=B.[dmde_10],A.[dmde_11]=B.[dmde_11],A.[dmde_2]=B.[dmde_2],A.[dmde_3]=B.[dmde_3],A.[dmde_4]=B.[dmde_4],A.[dmde_5]=B.[dmde_5],A.[dmde_6]=B.[dmde_6],A.[dmde_7]=B.[dmde_7],A.[dmde_8]=B.[dmde_8],A.[dmde_9]=B.[dmde_9],A.[dmse_1]=B.[dmse_1],A.[dmse_10]=B.[dmse_10],A.[dmse_11]=B.[dmse_11],A.[dmse_2]=B.[dmse_2],A.[dmse_3]=B.[dmse_3],A.[dmse_4]=B.[dmse_4],A.[dmse_5]=B.[dmse_5],A.[dmse_6]=B.[dmse_6],A.[dmse_7]=B.[dmse_7],A.[dmse_8]=B.[dmse_8],A.[dmse_9]=B.[dmse_9],A.[dmth_1]=B.[dmth_1],A.[dmth_10]=B.[dmth_10],A.[dmth_11]=B.[dmth_11],A.[dmth_2]=B.[dmth_2],A.[dmth_3]=B.[dmth_3],A.[dmth_4]=B.[dmth_4],A.[dmth_5]=B.[dmth_5],A.[dmth_6]=B.[dmth_6],A.[dmth_7]=B.[dmth_7],A.[dmth_8]=B.[dmth_8],A.[dmth_9]=B.[dmth_9],A.[dmth_kw_1]=B.[dmth_kw_1],A.[dmth_kw_10]=B.[dmth_kw_10],A.[dmth_kw_11]=B.[dmth_kw_11],A.[dmth_kw_2]=B.[dmth_kw_2],A.[dmth_kw_3]=B.[dmth_kw_3],A.[dmth_kw_4]=B.[dmth_kw_4],A.[dmth_kw_5]=B.[dmth_kw_5],A.[dmth_kw_6]=B.[dmth_kw_6],A.[dmth_kw_7]=B.[dmth_kw_7],A.[dmth_kw_8]=B.[dmth_kw_8],A.[dmth_kw_9]=B.[dmth_kw_9],A.[dmty_1]=B.[dmty_1],A.[dmty_10]=B.[dmty_10],A.[dmty_11]=B.[dmty_11],A.[dmty_2]=B.[dmty_2],A.[dmty_3]=B.[dmty_3],A.[dmty_4]=B.[dmty_4],A.[dmty_5]=B.[dmty_5],A.[dmty_6]=B.[dmty_6],A.[dmty_7]=B.[dmty_7],A.[dmty_8]=B.[dmty_8],A.[dmty_9]=B.[dmty_9],A.[dmty_kw_1]=B.[dmty_kw_1],A.[dmty_kw_10]=B.[dmty_kw_10],A.[dmty_kw_11]=B.[dmty_kw_11],A.[dmty_kw_2]=B.[dmty_kw_2],A.[dmty_kw_3]=B.[dmty_kw_3],A.[dmty_kw_4]=B.[dmty_kw_4],A.[dmty_kw_5]=B.[dmty_kw_5],A.[dmty_kw_6]=B.[dmty_kw_6],A.[dmty_kw_7]=B.[dmty_kw_7],A.[dmty_kw_8]=B.[dmty_kw_8],A.[dmty_kw_9]=B.[dmty_kw_9],A.[dorg_1]=B.[dorg_1],A.[dorg_10]=B.[dorg_10],A.[dorg_11]=B.[dorg_11],A.[dorg_2]=B.[dorg_2],A.[dorg_3]=B.[dorg_3],A.[dorg_4]=B.[dorg_4],A.[dorg_5]=B.[dorg_5],A.[dorg_6]=B.[dorg_6],A.[dorg_7]=B.[dorg_7],A.[dorg_8]=B.[dorg_8],A.[dorg_9]=B.[dorg_9],A.[dorg_kw_1]=B.[dorg_kw_1],A.[dorg_kw_10]=B.[dorg_kw_10],A.[dorg_kw_11]=B.[dorg_kw_11],A.[dorg_kw_2]=B.[dorg_kw_2],A.[dorg_kw_3]=B.[dorg_kw_3],A.[dorg_kw_4]=B.[dorg_kw_4],A.[dorg_kw_5]=B.[dorg_kw_5],A.[dorg_kw_6]=B.[dorg_kw_6],A.[dorg_kw_7]=B.[dorg_kw_7],A.[dorg_kw_8]=B.[dorg_kw_8],A.[dorg_kw_9]=B.[dorg_kw_9],A.[dtrm]=B.[dtrm],A.[dtrm_kw]=B.[dtrm_kw],A.[effn]=B.[effn],A.[elgb]=B.[elgb],A.[elgb_kw]=B.[elgb_kw],A.[etpc]=B.[etpc],A.[etpc_kw]=B.[etpc_kw],A.[exmt]=B.[exmt],A.[exmt_kw]=B.[exmt_kw],A.[fire]=B.[fire],A.[fire_kw]=B.[fire_kw],A.[fono]=B.[fono],A.[fopo]=B.[fopo],A.[gefo]=B.[gefo],A.[gefo_kw]=B.[gefo_kw],A.[glco]=B.[glco],A.[hisa]=B.[hisa],A.[hisa_kw]=B.[hisa_kw],A.[iamt]=B.[iamt],A.[invc]=B.[invc],A.[invc_kw]=B.[invc_kw],A.[invd]=B.[invd],A.[invn]=B.[invn],A.[issp]=B.[issp],A.[issp_kw]=B.[issp_kw],A.[item]=B.[item],A.[iwgt]=B.[iwgt],A.[iwun]=B.[iwun],A.[kitm]=B.[kitm],A.[kitm_kw]=B.[kitm_kw],A.[lccl]=B.[lccl],A.[lcrq]=B.[lcrq],A.[lcrq_kw]=B.[lcrq_kw],A.[ldam_1]=B.[ldam_1],A.[ldam_10]=B.[ldam_10],A.[ldam_11]=B.[ldam_11],A.[ldam_2]=B.[ldam_2],A.[ldam_3]=B.[ldam_3],A.[ldam_4]=B.[ldam_4],A.[ldam_5]=B.[ldam_5],A.[ldam_6]=B.[ldam_6],A.[ldam_7]=B.[ldam_7],A.[ldam_8]=B.[ldam_8],A.[ldam_9]=B.[ldam_9],A.[ldat]=B.[ldat],A.[leng]=B.[leng],A.[logn]=B.[logn],A.[lsel]=B.[lsel],A.[lsel_kw]=B.[lsel_kw],A.[lseq]=B.[lseq],A.[lsid]=B.[lsid],A.[lstn]=B.[lstn],A.[manp]=B.[manp],A.[manp_kw]=B.[manp_kw],A.[mitm]=B.[mitm],A.[mnlp]=B.[mnlp],A.[mnsq]=B.[mnsq],A.[mnwo]=B.[mnwo],A.[mpnr]=B.[mpnr],A.[mpsn]=B.[mpsn],A.[mrdt]=B.[mrdt],A.[oamt]=B.[oamt],A.[odat]=B.[odat],A.[odno]=B.[odno],A.[odty]=B.[odty],A.[odty_kw]=B.[odty_kw],A.[oltp]=B.[oltp],A.[oltp_kw]=B.[oltp_kw],A.[oorn]=B.[oorn],A.[opno]=B.[opno],A.[opon]=B.[opon],A.[osqn]=B.[osqn],A.[otbp]=B.[otbp],A.[owno]=B.[owno],A.[ownr]=B.[ownr],A.[owns]=B.[owns],A.[owns_kw]=B.[owns_kw],A.[paft]=B.[paft],A.[paft_kw]=B.[paft_kw],A.[paya]=B.[paya],A.[pcsr]=B.[pcsr],A.[pcsr_kw]=B.[pcsr_kw],A.[pdno]=B.[pdno],A.[pegd]=B.[pegd],A.[pegd_kw]=B.[pegd_kw],A.[pgmd]=B.[pgmd],A.[pgmd_kw]=B.[pgmd_kw],A.[pmde]=B.[pmde],A.[pmnd]=B.[pmnd],A.[pmnd_kw]=B.[pmnd_kw],A.[pmni]=B.[pmni],A.[pmni_kw]=B.[pmni_kw],A.[pmnt]=B.[pmnt],A.[pmnt_kw]=B.[pmnt_kw],A.[pmse]=B.[pmse],A.[pmsk]=B.[pmsk],A.[porg]=B.[porg],A.[porg_kw]=B.[porg_kw],A.[posi]=B.[posi],A.[ppon]=B.[ppon],A.[pric]=B.[pric],A.[prsg]=B.[prsg],A.[prtp]=B.[prtp],A.[pseq]=B.[pseq],A.[ptpa]=B.[ptpa],A.[ptpe]=B.[ptpe],A.[qalt]=B.[qalt],A.[qbbc]=B.[qbbc],A.[qccf]=B.[qccf],A.[qiap]=B.[qiap],A.[qibo]=B.[qibo],A.[qibp]=B.[qibp],A.[qidl]=B.[qidl],A.[qiiv]=B.[qiiv],A.[qilh]=B.[qilh],A.[qips]=B.[qips],A.[qirj]=B.[qirj],A.[qish]=B.[qish],A.[qmmr]=B.[qmmr],A.[qono]=B.[qono],A.[qoor]=B.[qoor],A.[qpon]=B.[qpon],A.[qrrq]=B.[qrrq],A.[qseq]=B.[qseq],A.[qual]=B.[qual],A.[qual_kw]=B.[qual_kw],A.[rcod]=B.[rcod],A.[rdta]=B.[rdta],A.[refs]=B.[refs],A.[rels]=B.[rels],A.[rels_kw]=B.[rels_kw],A.[reno]=B.[reno],A.[reto]=B.[reto],A.[retp]=B.[retp],A.[rets]=B.[rets],A.[revi]=B.[revi],A.[revn]=B.[revn],A.[rqno]=B.[rqno],A.[rqpo]=B.[rqpo],A.[rqtp]=B.[rqtp],A.[rqtp_kw]=B.[rqtp_kw],A.[rseq]=B.[rseq],A.[rtyn]=B.[rtyn],A.[rtyn_kw]=B.[rtyn_kw],A.[rtyp]=B.[rtyp],A.[rtyp_kw]=B.[rtyp_kw],A.[sbim]=B.[sbim],A.[sbim_kw]=B.[sbim_kw],A.[sbmt]=B.[sbmt],A.[schu]=B.[schu],A.[schu_kw]=B.[schu_kw],A.[sctp]=B.[sctp],A.[sctp_kw]=B.[sctp_kw],A.[sdsc]=B.[sdsc],A.[sdsc_kw]=B.[sdsc_kw],A.[serl]=B.[serl],A.[serv]=B.[serv],A.[sfad]=B.[sfad],A.[sfbp]=B.[sfbp],A.[sfcn]=B.[sfcn],A.[sfsi]=B.[sfsi],A.[sfwh]=B.[sfwh],A.[shdt]=B.[shdt],A.[site]=B.[site],A.[sorn]=B.[sorn],A.[spcn]=B.[spcn],A.[spon]=B.[spon],A.[srpo]=B.[srpo],A.[srsq]=B.[srsq],A.[srvo]=B.[srvo],A.[sseq]=B.[sseq],A.[stat]=B.[stat],A.[stat_kw]=B.[stat_kw],A.[stcd]=B.[stcd],A.[stcd_kw]=B.[stcd_kw],A.[stdc]=B.[stdc],A.[stsc]=B.[stsc],A.[stsc_kw]=B.[stsc_kw],A.[stsd]=B.[stsd],A.[stsd_kw]=B.[stsd_kw],A.[styp]=B.[styp],A.[styp_kw]=B.[styp_kw],A.[subc]=B.[subc],A.[subc_kw]=B.[subc_kw],A.[tapr]=B.[tapr],A.[taxp]=B.[taxp],A.[taxp_kw]=B.[taxp_kw],A.[thic]=B.[thic],A.[ztimestamp]=B.[ztimestamp],A.[tpbk]=B.[tpbk],A.[tpbl]=B.[tpbl],A.[txta]=B.[txta],A.[vrpr]=B.[vrpr],A.[vrpr_kw]=B.[vrpr_kw],A.[widt]=B.[widt],A.[file_name]=B.[file_name],A.[dwh_load_time]=B.[dwh_load_time],A.[otad]=B.[otad],A.[prno]=B.[prno],A.[ccur]=B.[ccur],A.[crin_kw]=B.[crin_kw],A.[ifbp]=B.[ifbp],A.[ccrs]=B.[ccrs],A.[hisp_kw]=B.[hisp_kw],A.[cvyn_kw]=B.[cvyn_kw],A.[odis]=B.[odis],A.[ptad]=B.[ptad],A.[ptbp]=B.[ptbp],A.[ptcn]=B.[ptcn],A.[plnr]=B.[plnr],A.[cotp]=B.[cotp],A.[hdst_kw]=B.[hdst_kw]
	WHEN NOT MATCHED BY TARGET THEN 
	INSERT ([acti],[adin],[akcd],[amld],[amod],[amta],[appr],[appr_kw],[asno],[bgrb],[bgrb_kw],[bgrq],[bgrq_kw],[bgxc],[bgxc_kw],[bkyn],[bkyn_kw],[bpcl],
[bptc],[btsp],[btsp_kw],[btx1],[btx2],[cact],[cadr],[casi],[ccco],[ccof],[ccty],[cdec],[cdis_1],[cdis_10],[cdis_11],[cdis_2],[cdis_3],[cdis_4],[cdis_5],[cdis_6],[cdis_7],[cdis_8],[cdis_9],[ceno],[cfap],[cfap_kw],[cfrw],[citg],[citt],[ckor],[ckor_kw],[clip],[clip_kw],[clot],[clyn],[clyn_kw],[cmnf],[cncd],[cnig],[cnig_kw],[cnpt],[cnpt_kw],[comm],[comm_kw],[compnr],[cono],[coop_1],[coop_2],[coop_3],[copr_1],[copr_2],[copr_3],[corg],[corg_kw],[cosn],[cpay],[cpcl],[cpcp],[cpgp],[cpln],[cprj],[cpva],[crbn],[crbn_kw],[crcd],[crej],[crit],[crrf],[crrf_kw],[csgp],[cspa],[csqn],[cstl],[ctcd],[ctrj],[cubp],[cucf],[cumr],[cupp],[cuqp],[curq],[cuva],[cvat],[cvbp],[cvcf],[cvmr],[cvpp],[cvqp],[cvrq],[cwar],[damt],[ddon],[ddta],[ddtb],[ddtc],[ddtd],[ddte],[ddtf],[deleted],[dino],[disc_1],[disc_10],[disc_11],[disc_2],[disc_3],[disc_4],[disc_5],[disc_6],[disc_7],[disc_8],[disc_9],[dmde_1],[dmde_10],[dmde_11],[dmde_2],[dmde_3],[dmde_4],[dmde_5],[dmde_6],[dmde_7],[dmde_8],[dmde_9],[dmse_1],[dmse_10],[dmse_11],[dmse_2],[dmse_3],[dmse_4],[dmse_5],[dmse_6],[dmse_7],[dmse_8],[dmse_9],[dmth_1],[dmth_10],[dmth_11],[dmth_2],[dmth_3],[dmth_4],[dmth_5],[dmth_6],[dmth_7],[dmth_8],[dmth_9],[dmth_kw_1],[dmth_kw_10],[dmth_kw_11],[dmth_kw_2],[dmth_kw_3],[dmth_kw_4],[dmth_kw_5],[dmth_kw_6],[dmth_kw_7],[dmth_kw_8],[dmth_kw_9],[dmty_1],[dmty_10],[dmty_11],[dmty_2],[dmty_3],[dmty_4],[dmty_5],[dmty_6],[dmty_7],[dmty_8],[dmty_9],[dmty_kw_1],[dmty_kw_10],[dmty_kw_11],[dmty_kw_2],[dmty_kw_3],[dmty_kw_4],[dmty_kw_5],[dmty_kw_6],[dmty_kw_7],[dmty_kw_8],[dmty_kw_9],[dorg_1],[dorg_10],[dorg_11],[dorg_2],[dorg_3],[dorg_4],[dorg_5],[dorg_6],[dorg_7],[dorg_8],[dorg_9],[dorg_kw_1],[dorg_kw_10],[dorg_kw_11],[dorg_kw_2],[dorg_kw_3],[dorg_kw_4],[dorg_kw_5],[dorg_kw_6],[dorg_kw_7],[dorg_kw_8],[dorg_kw_9],[dtrm],[dtrm_kw],[effn],[elgb],[elgb_kw],[etpc],[etpc_kw],[exmt],[exmt_kw],[fire],[fire_kw],[fono],[fopo],[gefo],[gefo_kw],[glco],[hisa],[hisa_kw],[iamt],[invc],[invc_kw],[invd],[invn],[issp],[issp_kw],[item],[iwgt],[iwun],[kitm],[kitm_kw],[lccl],[lcrq],[lcrq_kw],[ldam_1],[ldam_10],[ldam_11],[ldam_2],[ldam_3],[ldam_4],[ldam_5],[ldam_6],[ldam_7],[ldam_8],[ldam_9],[ldat],[leng],[logn],[lsel],[lsel_kw],[lseq],[lsid],[lstn],[manp],[manp_kw],[mitm],[mnlp],[mnsq],[mnwo],[mpnr],[mpsn],[mrdt],[oamt],[odat],[odno],[odty],[odty_kw],[oltp],[oltp_kw],[oorn],[opno],[opon],[orno],[osqn],[otbp],[owno],[ownr],[owns],[owns_kw],[paft],[paft_kw],[paya],[pcsr],[pcsr_kw],[pdno],[pegd],[pegd_kw],[pgmd],[pgmd_kw],[pmde],[pmnd],[pmnd_kw],[pmni],[pmni_kw],[pmnt],[pmnt_kw],[pmse],[pmsk],[pono],[porg],[porg_kw],[posi],[ppon],[pric],[prsg],[prtp],[pseq],[ptpa],[ptpe],[qalt],[qbbc],[qccf],[qiap],[qibo],[qibp],[qidl],[qiiv],[qilh],[qips],[qirj],[qish],[qmmr],[qono],[qoor],[qpon],[qrrq],[qseq],[qual],[qual_kw],[rcod],[rdta],[refs],[rels],[rels_kw],[reno],[reto],[retp],[rets],[revi],[revn],[rqno],[rqpo],[rqtp],[rqtp_kw],[rseq],[rtyn],[rtyn_kw],[rtyp],[rtyp_kw],[sbim],[sbim_kw],[sbmt],[schu],[schu_kw],[sctp],[sctp_kw],[sdsc],[sdsc_kw],[serl],[sern],[serv],[sfad],[sfbp],[sfcn],[sfsi],[sfwh],[shdt],[site],[sorn],[spcn],[spon],[sqnb],[srpo],[srsq],[srvo],[sseq],[stat],[stat_kw],[stcd],[stcd_kw],[stdc],[stsc],[stsc_kw],[stsd],[stsd_kw],[styp],[styp_kw],[subc],[subc_kw],[tapr],[taxp],[taxp_kw],[thic],[ztimestamp],[tpbk],[tpbl],[trdt],[txta],[vrpr],[vrpr_kw],[widt],[file_name],[dwh_load_time],[otad],[prno],[ccur],[crin_kw],[ifbp],[ccrs],[hisp_kw],[cvyn_kw],[odis],[ptad],[ptbp],[ptcn],[plnr],[cotp],[hdst_kw],[PU_Order_Line_His_fct_key])
	VALUES
	(B.[acti],B.[adin],B.[akcd],B.[amld],B.[amod],B.[amta],B.[appr],B.[appr_kw],B.[asno],B.[bgrb],B.[bgrb_kw],B.[bgrq],B.[bgrq_kw],B.[bgxc],B.[bgxc_kw],B.[bkyn],B.[bkyn_kw],B.[bpcl],
[bptc],B.[btsp],B.[btsp_kw],B.[btx1],B.[btx2],B.[cact],B.[cadr],B.[casi],B.[ccco],B.[ccof],B.[ccty],B.[cdec],B.[cdis_1],B.[cdis_10],B.[cdis_11],B.[cdis_2],B.[cdis_3],B.[cdis_4],B.[cdis_5],B.[cdis_6],B.[cdis_7],B.[cdis_8],B.[cdis_9],B.[ceno],B.[cfap],B.[cfap_kw],B.[cfrw],B.[citg],B.[citt],B.[ckor],B.[ckor_kw],B.[clip],B.[clip_kw],B.[clot],B.[clyn],B.[clyn_kw],B.[cmnf],B.[cncd],B.[cnig],B.[cnig_kw],B.[cnpt],B.[cnpt_kw],B.[comm],B.[comm_kw],B.[compnr],B.[cono],B.[coop_1],B.[coop_2],B.[coop_3],B.[copr_1],B.[copr_2],B.[copr_3],B.[corg],B.[corg_kw],B.[cosn],B.[cpay],B.[cpcl],B.[cpcp],B.[cpgp],B.[cpln],B.[cprj],B.[cpva],B.[crbn],B.[crbn_kw],B.[crcd],B.[crej],B.[crit],B.[crrf],B.[crrf_kw],B.[csgp],B.[cspa],B.[csqn],B.[cstl],B.[ctcd],B.[ctrj],B.[cubp],B.[cucf],B.[cumr],B.[cupp],B.[cuqp],B.[curq],B.[cuva],B.[cvat],B.[cvbp],B.[cvcf],B.[cvmr],B.[cvpp],B.[cvqp],B.[cvrq],B.[cwar],B.[damt],B.[ddon],B.[ddta],B.[ddtb],B.[ddtc],B.[ddtd],B.[ddte],B.[ddtf],B.[deleted],B.[dino],B.[disc_1],B.[disc_10],B.[disc_11],B.[disc_2],B.[disc_3],B.[disc_4],B.[disc_5],B.[disc_6],B.[disc_7],B.[disc_8],B.[disc_9],B.[dmde_1],B.[dmde_10],B.[dmde_11],B.[dmde_2],B.[dmde_3],B.[dmde_4],B.[dmde_5],B.[dmde_6],B.[dmde_7],B.[dmde_8],B.[dmde_9],B.[dmse_1],B.[dmse_10],B.[dmse_11],B.[dmse_2],B.[dmse_3],B.[dmse_4],B.[dmse_5],B.[dmse_6],B.[dmse_7],B.[dmse_8],B.[dmse_9],B.[dmth_1],B.[dmth_10],B.[dmth_11],B.[dmth_2],B.[dmth_3],B.[dmth_4],B.[dmth_5],B.[dmth_6],B.[dmth_7],B.[dmth_8],B.[dmth_9],B.[dmth_kw_1],B.[dmth_kw_10],B.[dmth_kw_11],B.[dmth_kw_2],B.[dmth_kw_3],B.[dmth_kw_4],B.[dmth_kw_5],B.[dmth_kw_6],B.[dmth_kw_7],B.[dmth_kw_8],B.[dmth_kw_9],B.[dmty_1],B.[dmty_10],B.[dmty_11],B.[dmty_2],B.[dmty_3],B.[dmty_4],B.[dmty_5],B.[dmty_6],B.[dmty_7],B.[dmty_8],B.[dmty_9],B.[dmty_kw_1],B.[dmty_kw_10],B.[dmty_kw_11],B.[dmty_kw_2],B.[dmty_kw_3],B.[dmty_kw_4],B.[dmty_kw_5],B.[dmty_kw_6],B.[dmty_kw_7],B.[dmty_kw_8],B.[dmty_kw_9],B.[dorg_1],B.[dorg_10],B.[dorg_11],B.[dorg_2],B.[dorg_3],B.[dorg_4],B.[dorg_5],B.[dorg_6],B.[dorg_7],B.[dorg_8],B.[dorg_9],B.[dorg_kw_1],B.[dorg_kw_10],B.[dorg_kw_11],B.[dorg_kw_2],B.[dorg_kw_3],B.[dorg_kw_4],B.[dorg_kw_5],B.[dorg_kw_6],B.[dorg_kw_7],B.[dorg_kw_8],B.[dorg_kw_9],B.[dtrm],B.[dtrm_kw],B.[effn],B.[elgb],B.[elgb_kw],B.[etpc],B.[etpc_kw],B.[exmt],B.[exmt_kw],B.[fire],B.[fire_kw],B.[fono],B.[fopo],B.[gefo],B.[gefo_kw],B.[glco],B.[hisa],B.[hisa_kw],B.[iamt],B.[invc],B.[invc_kw],B.[invd],B.[invn],B.[issp],B.[issp_kw],B.[item],B.[iwgt],B.[iwun],B.[kitm],B.[kitm_kw],B.[lccl],B.[lcrq],B.[lcrq_kw],B.[ldam_1],B.[ldam_10],B.[ldam_11],B.[ldam_2],B.[ldam_3],B.[ldam_4],B.[ldam_5],B.[ldam_6],B.[ldam_7],B.[ldam_8],B.[ldam_9],B.[ldat],B.[leng],B.[logn],B.[lsel],B.[lsel_kw],B.[lseq],B.[lsid],B.[lstn],B.[manp],B.[manp_kw],B.[mitm],B.[mnlp],B.[mnsq],B.[mnwo],B.[mpnr],B.[mpsn],B.[mrdt],B.[oamt],B.[odat],B.[odno],B.[odty],B.[odty_kw],B.[oltp],B.[oltp_kw],B.[oorn],B.[opno],B.[opon],B.[orno],B.[osqn],B.[otbp],B.[owno],B.[ownr],B.[owns],B.[owns_kw],B.[paft],B.[paft_kw],B.[paya],B.[pcsr],B.[pcsr_kw],B.[pdno],B.[pegd],B.[pegd_kw],B.[pgmd],B.[pgmd_kw],B.[pmde],B.[pmnd],B.[pmnd_kw],B.[pmni],B.[pmni_kw],B.[pmnt],B.[pmnt_kw],B.[pmse],B.[pmsk],B.[pono],B.[porg],B.[porg_kw],B.[posi],B.[ppon],B.[pric],B.[prsg],B.[prtp],B.[pseq],B.[ptpa],B.[ptpe],B.[qalt],B.[qbbc],B.[qccf],B.[qiap],B.[qibo],B.[qibp],B.[qidl],B.[qiiv],B.[qilh],B.[qips],B.[qirj],B.[qish],B.[qmmr],B.[qono],B.[qoor],B.[qpon],B.[qrrq],B.[qseq],B.[qual],B.[qual_kw],B.[rcod],B.[rdta],B.[refs],B.[rels],B.[rels_kw],B.[reno],B.[reto],B.[retp],B.[rets],B.[revi],B.[revn],B.[rqno],B.[rqpo],B.[rqtp],B.[rqtp_kw],B.[rseq],B.[rtyn],B.[rtyn_kw],B.[rtyp],B.[rtyp_kw],B.[sbim],B.[sbim_kw],B.[sbmt],B.[schu],B.[schu_kw],B.[sctp],B.[sctp_kw],B.[sdsc],B.[sdsc_kw],B.[serl],B.[sern],B.[serv],B.[sfad],B.[sfbp],B.[sfcn],B.[sfsi],B.[sfwh],B.[shdt],B.[site],B.[sorn],B.[spcn],B.[spon],B.[sqnb],B.[srpo],B.[srsq],B.[srvo],B.[sseq],B.[stat],B.[stat_kw],B.[stcd],B.[stcd_kw],B.[stdc],B.[stsc],B.[stsc_kw],B.[stsd],B.[stsd_kw],B.[styp],B.[styp_kw],B.[subc],B.[subc_kw],B.[tapr],B.[taxp],B.[taxp_kw],B.[thic],B.[ztimestamp],B.[tpbk],B.[tpbl],B.[trdt],B.[txta],B.[vrpr],B.[vrpr_kw],B.[widt],B.[file_name],B.[dwh_load_time],B.[otad],B.[prno],B.[ccur],B.[crin_kw],B.[ifbp],B.[ccrs],B.[hisp_kw],B.[cvyn_kw],B.[odis],B.[ptad],B.[ptbp],B.[ptcn],B.[plnr],B.[cotp],B.[hdst_kw],B.[PU_Order_Line_His_fct_key])
	OPTION (LABEL = '[SP_22_AP_Pur_Order_Line_History_fct_8]');

									  
	END TRY

	BEGIN CATCH
		IF @@TRANCOUNT > 0
			ROLLBACK TRANSACTION;
		ELSE
			COMMIT TRANSACTION;

		DECLARE @ErrorMessage NVARCHAR(4000);
		DECLARE @ErrorSeverity INT;
		DECLARE @ErrorState INT;

		SELECT @ErrorMessage = ERROR_MESSAGE();

		SELECT @ErrorSeverity = ERROR_SEVERITY();

		SELECT @ErrorState = ERROR_STATE();

		RAISERROR (
				@ErrorMessage
				,@ErrorSeverity
				,@ErrorState
				);
	END CATCH

	COMMIT TRANSACTION;
END;
GO


